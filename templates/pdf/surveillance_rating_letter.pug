doctype html
head
  meta(charset='UTF-8')
  meta(http-equiv='X-UA-Compatible' content='IE=edge')
  meta(name='viewport' content='width=device-width, initial-scale=1.0')
  title Surveillance Rating Letter
  style.
    * {
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Arial';
    }
    section {
      margin: 0 1.5rem;
      line-height: 1.5rem;
    }
    
    main {
      font-style: italic;
    }
    main > section {
      margin: 0 3rem;
    }
    .table-div{
      overflow-x: auto;
      margin: 1rem
    }
    table {
      border-collapse: collapse;
      width: 100%;
      border: 1px solid black;
      border-spacing: 0;
    }
    thead {
      color: #111;
      height: 25px;
    }
    th, td{
      border: 1px solid black;
      text-align: left;
      padding: 8px;
    }
    footer{
      margin: 1.5rem 1rem;
    }



body 
  header 
    section 
      h1 Surveillance Rating Letter 
      br
      p(style="margin-bottom: 6rem") Shri/Ms.
      section 
      p Dear Sir/Madam,
      p(style="text-align: center; margin-top: 2rem") 
        strong 
          u Credit rating for bank facilities
      p(style="width: 80%; margin: auto;") After taking into account all the relevant recent developments including operational and financial performance of your company for FY and Q1FYyy/H1FYyy/9MFYyy, 
        | Our Rating Committee has reviewed the following ratings:
  main 
    div(class="table-div")
      table 
        thead 
          tr 
            th Facilities
            th(style="text-align: center") Amount (Rs. Crore)
            th(style="text-align: center") Current Ratings
            th(style="text-align: center") Previous Ratings 
            th(style="text-align: center") Rating Action 
        tbody
          each company, key in data     
            tr 
              td #{company.category_text}
              td(style="text-align: center") #{company.instrument_size_number}
              td(style="text-align: center") #{company.rating}
              td(style="text-align: center") #{company.previous_rating}
              td(style="text-align: center") #{company.rating_action}
          tr(class="total")
              td(style="font-weight: 600") Total
              td(style="font-weight: 600; text-transform: capitalize; text-align: center;" class="amount") XX
              td
              td 
              td 
    section
      ol
        li Details of the credit facilities are attached in 
          strong Annexure I.
          | Our rating symbols for long-term and short-term ratings and explanatory notes thereon are attached in 
          strong Annexure II.
        li  The press release for the rating(s) will be communicated to you shortly.
        li The above rating is normally valid for a period of one year from the date of communication of the rating to you (that is. 
          strong Month XX, 20XX).
        li If the proposed long term / short term facility (if any) is not availed within a period of six months / three months respectively from the date of this letter, then the rating may please be revalidated from us before availing the facility.
        li INFOMERICS reserves the right to undertake a surveillance/review of the rating(s) from time to time, based on circumstances warranting such review, subject to at least one such review/surveillance every year. 
        li A formal surveillance/review of the rating is normally conducted within 12 months from the date of initial rating/last review of the rating. However, INFOMERICS reserves the right to undertake a surveillance/review of the rating more than once a year if in the opinion of INFOMERICS, circumstances warrant such surveillance/review.
        li 
          strong You shall provide us with a No Default Statement as at the last date of the month on the first date of succeeding month without fail. 
          | The NDS shall be mailed every month to 
          a(href="mailto:nds@Infomerics.com" target="_blank" rel="noreferrer") nds@Infomerics.com
          | and to the mail id of the undersigned.
        li
          strong You shall provide the quarterly performance results/quarterly operational data 
          span(style="text-decoration: line-through") (being submitted to Banks) 
          | to us within 6 weeks from the close of each calendar quarter for our review/monitoring.
        li You shall furnish all material information and any other information called for by INFOMERICS in a timely manner, for monitoring the rating assigned by INFOMERICS. In the event of failure on your part in furnishing such information, to carry out continuous monitoring of the rating of the bank facilities, INFOMERICS shall carry out the review/annual surveillance based on best available information throughout the lifetime of such bank facilities as per the policy of INFOMERICS.
        li Please note that INFOMERICS ratings are not recommendations to buy, sell or hold any security or to sanction, renew, disburse or recall the bank facilities. INFOMERICS does not take into account the sovereign risk, if any, attached to the foreign currency loans, and the ratings are applicable only to the rupee equivalent of these loans.
        li Users of this rating may kindly refer our website 
          a( rel="noreferrer" href="https://www.infomerics.com/" target="_blank") www.infomerics.com
          |  for latest update on the outstanding rating.
        li Further, this is to mention that all the clauses mentioned in the initial rating letter 
          strong dated Month XX, 20XX
          |  are also applicable. If you need any clarification, you are welcome to approach us in this regard.
  footer 
    p Thanking You 
    br
    p Yours faithfully,
    br
    div(style="display: flex; justify-content: space-between; line-height: 1.4rem") 
        div  
          p 
            strong #{data[0].rating_analyst}
          p Rating Analyst 
          p Email: #{data[0].rating_analyst_email} 
        div 
          p 
            strong #{data[0].group_head}
          p Group Head
          p Email: #{data[0].group_head_email}





script().
  let totalAssignedRating = document.querySelector(".amount")
  let amount = !{JSON.stringify(table_data)}
  let totalAmount = 0
  for (let i = 0; i < amount.length; i++) {
    totalAmount += Number(amount[i].amount)
  }
  totalAssignedRating.innerText = numberToEnglish(Math.floor(totalAmount))
  function numberToEnglish(n, custom_join_character) {
    let string = n.toString(),
        units, tens, scales, start, end, chunks, chunksLen, chunk, ints, i, word, words;
    let and = custom_join_character || 'and';
    /* Is number zero? */
    if (parseInt(string) === 0) {
        return 'zero';
    }
    /* Array of units as words */
    units = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
    /* Array of tens as words */
    tens = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
    /* Array of scales as words */
    scales = ['', 'thousand', 'million', 'billion', 'trillion', 'quadrillion', 'quintillion', 'sextillion', 'septillion', 'octillion', 'nonillion', 'decillion', 'undecillion', 'duodecillion', 'tredecillion', 'quatttuor-decillion', 'quindecillion', 'sexdecillion', 'septen-decillion', 'octodecillion', 'novemdecillion', 'vigintillion', 'centillion'];
    /* Split user arguemnt into 3 digit chunks from right to left */
    start = string.length;
    chunks = [];
    while (start > 0) {
        end = start;
        chunks.push(string.slice((start = Math.max(0, start - 3)), end));
    }
    /* Check if function has enough scale words to be able to stringify the user argument */
    chunksLen = chunks.length;
    if (chunksLen > scales.length) {
        return '';
    }
    /* Stringify each integer in each chunk */
    words = [];
    for (i = 0; i < chunksLen; i++) {
        chunk = parseInt(chunks[i]);
        if (chunk) {
            /* Split chunk into array of individual integers */
            ints = chunks[i].split('').reverse().map(parseFloat);
            /* If tens integer is 1, i.e. 10, then add 10 to units integer */
            if (ints[1] === 1) {
                ints[0] += 10;
            }
            /* Add scale word if chunk is not zero and array item exists */
            if ((word = scales[i])) {
                words.push(word);
            }
            /* Add unit word if array item exists */
            if ((word = units[ints[0]])) {
                words.push(word);
            }
            /* Add tens word if array item exists */
            if ((word = tens[ints[1]])) {
                words.push(word);
            }
            /* Add 'and' string after units or tens integer if: */
            if (ints[0] || ints[1]) {

                /* Chunk has a hundreds integer or chunk is the first of multiple chunks */
                if (ints[2] || !i && chunksLen) {
                    words.push(and);
                }
            }
            /* Add hundreds word if array item exists */
            if ((word = units[ints[2]])) {
                words.push(word + ' hundred');
            }
        }

    }

    return words.reverse().join(' ');

  }
